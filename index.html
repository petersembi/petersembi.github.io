<!-- 
    /**
    *This is a template for adding interactive maps to your site. 
    *Using leaflet opensource javascript library
    *The functionality can be extended to accomodate more markers
    *References: https://leafletjs.com/
    * https://www.youtube.com/playlist?list=PLNCPalajQvg55_lI2bkO2mvESqxrTwyJJ
    * https://gis.stackexchange.com/questions/261142/leaflet-mouseover-popup-makes-whole-map-move
    * https://gis.stackexchange.com/questions/31951/showing-popup-on-mouse-over-not-on-click-using-leaflet
    * Dependencies
    * Countries geojson data. 
    * The data can be found here:  https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-countries/
    * Use this software to open  the data you download from naturalearthdata.com:  QGIS which can be downloaded here: 
    * https://www.qgis.org/en/site/forusers/download.html
    * Happy coding.
    * To use marker cluster groups, check here:  https://github.com/asmaloney/Leaflet_Cluster_Example
    */
 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
     integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
     crossorigin=""/>
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

     <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
        crossorigin=""></script>

        <!-- Include  countries data -->
        <script src="https://raw.githubusercontent.com/petersembi/gnrc_Interactive_Map/master/data/markers.js"></script>
        <script src="data/countries.geojson"></script>
        <!-- <script src="data/markers.js"></script> -->
        
        <style>
            #map {
                height: 400px;
                width: 1000px;

            }
        </style>
    <title>INTERACTIVE GEO MAPS</title>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <h1>My Map</h1>

                <!-- Where the map will be shown. It must have the id map. You must define a height for this div -->
                <div id="map">

                </div>
            </div>
        </div>
    </div>
    
    <script>

        // set country color as per population estimate from the countries.geojson file.
        function getCountryColor(popEst)
        {
            if(popEst > 1000000)
            {
                return 'red';

            } else if (popEst > 5000000) {
                return 'blue';
            } else {
                return '#008697';
            }

        }
        // set country styles
        function countriesStyle(feature)
        {
            return {
                fillColor: getCountryColor(feature.properties.pop_est),
                weight: 2,
                opacity: 1,
                color: 'white', 
                dashArray: 3,
                fillOpacity: 0.7
            }
        }

        // Define the centre of the map
        var map = L.map('map').setView([43.8476,18.3564], 3);
        
        // specifying data for all countries
        var countriesLayer = L.geoJson(
            countries,
            {style : countriesStyle}
        ).addTo(map);
      


        /****=============Dynamically display the markers and pop up==============****/

        // var markerClusters = L.markerClusterGroup();

        for (var i = 0; i < markers.length; i++)
        {
            var popup = '<img style="width: 100%" src=\'' + markers[i].img_url +   '\'> <p class="text-center"> ' + markers[i].contact_person +'<br> ' + markers[i].contact_description;
                console.log(popup);
            
            var m = L.marker([markers[i].latitude, markers[i].longitude])
            m.addTo(map);
            m.bindPopup(popup);
            m.on('mouseover',  function(e) {
                this.openPopup();                
            });
            m.on('mouseout', function (e){
                this.closePopup();
            });
        }
    </script>
</body>
</html>